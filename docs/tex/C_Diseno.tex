\apendice{Especificación de diseño}

\section{Introducción}
En este apéndice se explica cómo están conformados los datos que utilizan las librerías usadas en el proyecto, así como la forma en la que está estructurado el mismo.

\section{Diseño de datos}
Todos los datos que he utilizado a lo largo del proyecto están en formato .csv. Lo más normal es que para cada conjunto de datos tenga los siguientes archivos:
\begin{itemize}
\tightlist
\item \textit{ratings.csv} 
\item \textit{users.csv}
\item \textit{items.csv}
\end{itemize}
La estructura de estos archivos suele ser: \textit{idUser, idItem, rating, timestamp} para \textit{ratings.csv}, \textit{idUser, name, feature1, ..., featureN} para \textit{users.csv} y i\textit{dItem, name, feature1, ..., featureN} para \textit{items.csv}.

Para poder trabajar con los datos primero los paso a \textit{DataFrames} de \textit{pandas} \cite{dataframes}.

\subsection{Datos con LightFM}\label{datos-lightfm}
Una vez obtenidos los \textit{DataFrames} para cada \textit{.csv}, necesito convertirlos a \textit{Dataset} de \textit{LightFM} \cite{dataset-lightfm} para poder trabajar con ellos.

Esta clase se encarga de convertir los datos almacenados en los \textit{DataFrames} en \textit{matrices COO} y \textit{matrices CSR}.

\section{Diseño procedimental}

\section{Diseño arquitectónico}
Para la realización de este proyecto se ha seguido el patrón arquitectónico MVC (\textit{Modelo Vista Controlador}). El objetivo de este patrón es dividir el código en función de su propósito. Sus partes son:
\begin{itemize}
\tightlist
\item \textit{Modelo}: el acceso a los datos. Se corresponde con las clases de Entrada y Salida, que leen los datos para dárselo al sistema de recomendación y guardan los resultados.
\item \textit{Vista}: la visualización de los datos. Se corresponde con las clases de Interfaz, que muestran la información solicitada.
\item \textit{Controlador}: la manipulación de los datos. Se corresponde con los clases de Sistema, que crean los sistemas de recomendación gracias a los datos proporcionados por las clases de Entrada.
\end{itemize}

\imagen{patronMVC}{Esquema del patrón MVC \cite{mvc}}

La estructura del proyecto siguiendo este patrón quedaría de la siguiente forma:
\imagen{diagrama_src}{Diagrama UML del proyecto}
Por separado, los paquetes contienen:
\imagen{diagrama_vista}{Diagrama UML del paquete \textit{vista}}
\imagen{diagrama_controlador}{Diagrama UML del paquete \textit{controlador}}
\imagen{diagrama_modelo}{Diagrama UML del paquete \textit{modelo}}

\subsection{Diseño con LightFM}\label{diseño-lightfm}
Para la parte del modelo clásico, se tienen los siguientes archivos:
En la clase \texttt{EntradaLightFM} se tiene:
\begin{itemize}
\tightlist
\item \texttt{leer\_x}: estos métodos recogen los datos de los \textit{.csv} para cada conjunto de datos. Estos métodos son utilizados por los métodos de obtención de matrices de la clase \texttt{SistemaLightFM}.
\end{itemize}

En el archivo \texttt{Salida} se tiene:
\begin{itemize}
\tightlist
\item \texttt{imprimir\_resultados\_clasico}: este método imprime las métricas del modelo clásico escogido.
\end{itemize}

En el archivo \texttt{Persistencia} se tiene:
\begin{itemize}
\tightlist
\item \texttt{guardar\_matrices}: este método guarda en un archivo \textit{pickle} las matrices que \textit{LightFM} necesita para obtener los modelos.
\item \texttt{guardar\_modelo}: este método guarda el modelo obtenido por \textit{LightFM} en un archivo \textit{pickle}.
\end{itemize}

En el archivo \texttt{Interfaz} se tiene:
\begin{itemize}
\tightlist
\item \texttt{elegir\_dataset}: este método muestra un menú mediante el cual elegimos un conjunto de datos que utilizar.
\item \texttt{elegir\_modelo}: este método muestra un menú mediante el cual elegimos un modelo concreto a crear. 
\item \texttt{main\_clasico}: programa principal si el modelo escogido es \textit{LightFM}. 
\end{itemize}

En la clase \texttt{SistemaLightFM} tenemos:
\begin{itemize}
\tightlist
\item \texttt{matrices\_x}: estos métodos crean las matrices necesarias para cada conjunto de datos. 
\item \texttt{modelo\_x}: estos métodos crean los distintos modelos de recomendación. 
\item \texttt{resultados\_x}: estos métodos obtienen los resultados para cada modelo de recomendación. 
\end{itemize}

\subsection{Diseño con Spotlight}\label{diseño-spotlight}
Para la parte del modelo basado en aprendizaje profundo, se tienen los siguientes archivos:
En la clase \texttt{EntradaSpotlight} se tiene:
\begin{itemize}
\tightlist
\item \texttt{leer\_x}: estos métodos recogen los datos de los \textit{.csv} para cada conjunto de datos. Estos métodos son utilizados por los métodos de obtención de interacciones de la clase \texttt{SistemaSpotlight}.
\end{itemize}

En el archivo \texttt{Salida} se tiene:
\begin{itemize}
\tightlist
\item \texttt{imprimir\_resultados\_dl}: este método imprime las métricas del modelo basado en aprendizaje profundo escogido.
\end{itemize}

En el archivo \texttt{Persistencia} se tiene:
\begin{itemize}
\tightlist
\item \texttt{guardar\_interacciones}: este método guarda en un archivo \textit{pickle} las interacciones que \textit{Spotlight} necesita para obtener los modelos.
\item \texttt{guardar\_modelo\_dl}: este método guarda el modelo obtenido por \textit{Spotlight}.
\end{itemize}

En el archivo \texttt{Interfaz} se tiene:
\begin{itemize}
\tightlist 
\item \texttt{main\_dl}: programa principal si el modelo escogido es \textit{Spotlight}. 
\end{itemize}

En la clase \texttt{SistemaSpotlight} tenemos:
\begin{itemize}
\tightlist
\item \texttt{interacciones\_x}: estos métodos crean las interacciones necesarias para cada conjunto de datos. 
\item \texttt{modelo\_x}: estos métodos crean los distintos modelos de recomendación. 
\item \texttt{resultados\_x}: estos métodos obtienen los resultados para cada modelo de recomendación. 
\end{itemize}

